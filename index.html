<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>声鉴图生成</title>
	<style>
		body {
			width: 1024px;
			height: 1024px;
			background-color: #000000;
		}

		.pic {
			width: 700px;
			height: 700px;
			background-color: #FFFFFF;
		}
	</style>
</head>
<body>
<div style="display: none;">
	<img id="background" src="background.jpg" crossOrigin="anonymous">
	<img id="head" src="background.jpg" crossOrigin="anonymous">
	<canvas id="All" class="pic" width="700" height="700">
	</canvas>
</div>
<div style="background-color: #FFFFFF">
	名字：<input type="text" id="name" value="">
	<br/>
	主音色1：<input type="text" id="main1" value="">
	<br/>
	主音色2：<input type="text" id="main2" value="">
	<br/>
	辅音色1：<input type="text" id="fmain1" value="">
	<br/>
	辅音色2：<input type="text" id="fmain2" value="">
	<br/>
	辅音色3：<input type="text" id="fmain3" value="">
	<br/>
	辅音色4：<input type="text" id="fmain4" value="">
	<br/>
	声音星座：<input type="text" id="star" value="">
	<br/>
	导师心动：<input type="text" id="score1" value="">
	<br/>
	魅力分值：<input type="text" id="score2" value="">
	<br/>
	市场分值：<input type="text" id="score3" value="">
	<br/>
	桃花分值：<input type="text" id="score4" value="">
	<br/>
	推荐伴侣：<input type="text" id="hasb" value="">
	<br/>
	寄语：<input type="text" id="send" value="">
	<br/>
	ID：<input type="text" id="idid" value="20190202001">
	<br/>
	头像：<input type="file" id="headimage" value="">
	<br/>
	<button type="button" onclick="ok();">OK</button>
	<br/>
	<br/>
	<br/>
	<img id="result" src="">
</div>
<script src="https://www.desmg.com/resources/jquery/js/jquery.min.js"></script>
<script>
	$("#headimage").change(function () {
		let $file = $(this);
		let fileObj = $file[0];
		let windowURL = window.URL || window.webkitURL;
		let dataURL;
		let $img = $("#head");

		if (fileObj && fileObj.files && fileObj.files[0]) {
			dataURL = windowURL.createObjectURL(fileObj.files[0]);
			$img.attr('src', dataURL);
		} else {
			dataURL = $file.val();
			let imgObj = $img[0];
			imgObj.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";
			imgObj.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = dataURL;

		}
	});
</script>
<script>
	function ok() {
		let canvas1 = $('#All')[0];
		let ctx = canvas1.getContext('2d');
		ctx.drawImage($('#background')[0], 0, 0);
		ctx.fillStyle = "#5C3819";
		ctx.font = "normal bold 48px 方正隶书简体";
		ctx.fillText($('#name').val(), 100, 170);
		ctx.font = "normal bold 18px 黑体";
		ctx.fillText("主音色：" + $('#main1').val(), 100, 210);
		ctx.fillText("        " + $('#main2').val(), 100, 240);
		ctx.font = "normal normal 18px 黑体";
		ctx.fillText("辅音色：" + $('#fmain1').val(), 100, 270);
		ctx.fillText("        " + $('#fmain2').val(), 100, 300);
		ctx.fillText("        " + $('#fmain3').val(), 100, 330);
		ctx.fillText("        " + $('#fmain4').val(), 100, 360);
		ctx.font = "normal bold 20px 黑体";
		ctx.fillText("声音星座：" + $('#star').val(), 100, 390);
		ctx.font = "normal normal 20px 黑体";
		ctx.fillText("导师心动：" + $('#score1').val(), 100, 425);
		ctx.fillText("魅力分值：" + $('#score2').val(), 100, 465);
		ctx.fillText("市场分值：" + $('#score3').val(), 370, 425);
		ctx.fillText("桃花分值：" + $('#score4').val(), 370, 465);
		ctx.fillText("推荐伴侣：" + $('#hasb').val(), 100, 515);
		ctx.fillText("寄语：" + $('#send').val(), 100, 540);
		ctx.fillText("声鉴师：书九", 515, 605);
		ctx.fillText($('#idid').val(), 515, 635);
		ctx.drawImage($('#head')[0], 365, 125, 240, 240);
		$('#result').attr('src', canvas1.toDataURL('image/png'));
	}
</script>
</body>
</html>
